import java.io.IOException;
import java.nio.file.*;
import java.util.List;
import java.util.stream.Collectors;

//use Watch Service API for watching files
public class Main {

    public static void main(String[] args) throws IOException {
        Path root = Paths.get("/Users/elenavasilyeva/opt/folder");
        PathMatcher pathMatcher = FileSystems.getDefault().getPathMatcher("regex:stats_\\d+.txt");

        List<Path> files = Files.list(root)
                .filter(Files::isRegularFile)
                .filter(file -> pathMatcher.matches(file.getFileName()))
                .collect(Collectors.toUnmodifiableList());

        files.forEach(file-> System.out.println(Files.isRegularFile(file)));

        System.out.println(files);
        files.parallelStream().forEach(file -> {
            String content = null;
            try {
                content = Files.readString(file);
            } catch (IOException e) {
                e.printStackTrace();
            }

            System.out.println(content);
        });

        List<String> data = files.parallelStream()
                .map(file -> {
                    try {
                        return Files.readString(file).strip();
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                    return null;
                })
                .collect(Collectors.toList());

        System.out.println(data);
    }
}
